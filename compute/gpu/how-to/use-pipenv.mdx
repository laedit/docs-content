---
title: How to use the pipenv python virtual environment
description: This page explains how to use the pipenv python virtual environment with your GPU Instance
steps:
  - step: TODO
    type: HowToStep
    url: https://www.scaleway.com/en/docs/compute/gpu/use-pipenv
image: /assets/images/docs/scaleway.png
dates:
  validation: 2021-10-13
  posted: 2021-10-13
---


Prior to [TODO DATE], Scaleway GPU Instances were pre-installed with [Anaconda](https://www.anaconda.com) for managing python dependencies and virtual environments with Python. From [TO DO DATE], Pipenv will replace Anaconda on our Docker images.

Pipenv is a package and dependency manager for Python projects. It harnesses the power of different existing tools, bringing their functionalities together: 
  - `pip` for Python package management
  - `pyenv` for Python version management
  - `Virtualenv` for creating different virtual Python environments
  - `Pipfile` for managing project dependencies

Pipenv is pre-installed on all of Scaleway's AI Docker images for GPU Instances. A number of useful AI core packages and tools are also installed, including scipy, numpy, scikit-learn, jupyter, tensorflow and the Scakewat SDK. Depending on the container image you choose, other packages and tools will also be pre-installed, providing a convenient framework environment for you so that you can begin work immediately. For the full list of Scaleway's AI Docker images and their pre-installations, see [TODO INSERT LINK].

Regardless of your Docker image, you will be able to use Pipenv to install new packages and manage their versions across multiple different virtual environments if necessary.

<Message type="requirement">

- You have an account and are logged into the [Scaleway Console](https://console.scaleway.com) 
- You have created a [GPU Instance](TODO LINK)
- You have [generated your SSH key](TO DO LINK)
- You have followed the documenation for [using Docker with your GPU Instance](TO DO LINK)

</Message>

## Accessing the pipenv virtual environment

1. [Connect to your GPU Instance via SSH](TODO LINK). An operating system is installed, along with a minimum of other packages, including [Docker](link). Pipenv is **not** pre-installed here.

2. From your GPU Instance's shell, [launch one of Scaleway's Docker container images](TODO LINK). 

  You are now in a pre-activated `pipenv` virtual environment, with a number of tools and packages pre-installed, depending on the [Docker image you chose].

## Managing packages

1. Enter the following command to see all the packages and dependencies that are already installed in this environment, and their versions:

  `pipenv graph`

  Not only does the output show you the installed packages and their versions, but also all the other dependencies of each package.

  <Message type="tip">

    To check which version of a specific package is installed, use the command `pipenv graph | grep <package>`, replacing `<package>` with the name of the relevant package.
  
  </Message>

2. Enter the following command to install a new package:

  `pipenv install <package>`

  <Message type="tip">

    To install a specific version of a package, use the command `pipenv install <package>~=1.2`

3. Enter the following command to uninstall a package:

  `pipenv uninstall <package>`

4. Enter the following command to update a package:

  `pipenv update <package>`

  <Message type="tip">

    To update all packages, simply run `pipenv update`
  
  </Message>

## Launching an application in your local browser

Some applications, such as Jupyter Lab or Code Server, require a browser to run. You can launch these from your Docker container pipenv virtual environment, and view them in the browser of your local machine. This is thanks to the port mapping we specified when we ran the Docker container.

1. Launch an application. Here, we launch Jupyter Lab:

  `jupyter-lab`

  Within the output, you should see something similar to the following:

  ```
  [I 2021-10-15 14:34:30.288 ServerApp] Serving notebooks from local directory: /ai
  [I 2021-10-15 14:34:30.288 ServerApp] Jupyter Server 1.11.0 is running at:
  [I 2021-10-15 14:34:30.288 ServerApp] http://df88da66d38d:8888/lab?token=...
  [I 2021-10-15 14:34:30.288 ServerApp]  or http://127.0.0.1:8888/lab?token=...
  [I 2021-10-15 14:34:30.288 ServerApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
  ```

2. On your local computer, open a browser window and enter the following URL. Replace `<ip-address>` with the IP address of your Scaleway GPU Instance. This can be found in the Scaleway console, on the Instance's Overview tab.

  ```<ip-address>:8888/lab?token=scaleway42```>

  TODO: what will token be/how will they get it?

  Jupyter Lab now displays in your browser. You can use the Notebook, Console, or other features as required:

  <Lightbox src="scaleway-jupyter-lab.png" alt="" />

3. IUse CTRL+C in the terminal window of your GPU Instance / Docker container to close down the Jupyter server when you've finished.

## Understanding Pipfile

Every pipenv virtual environment has its own Pipfile. The Pipfile details the dependencies of the project, taking the place of the typical `requirements.txt` file. When you create a Pipenv environment, a Pipfile is automatically generated.

1. From the base directory of your pipenv activated environment, type `ls` to list all files in this directory

  The output should show a number of files, including `Pipfile` and `Pipfile.lock`

2. Enter the command `cat Pipfile` to view its contents:

    - `source` specifies the sources where available apackages are added/installed from 
    - `packages` lists the packages required for the project (production and development environments)
    - `dev-packages` lists the packages required for the project (development environments only)
    - `requires` specifes the required python version for the project

  Any packages that you explicitly install with the command `pipenv install <package>` will automatically be added to the Pipfile. However, note that the pre-installed packages of the virtual environment are not listed. [TODO CHECK NEXT BIT- WHAT ABOUT PIPFILE LOCK] You will need to add them yourself for easy installation of your project outside of the pre-installed environment. For example, if you will push your project to a Git repository, other users who clone it will be able to install all dependencies, based on the Pipfile, with the command `pipenv install`.

3. Enter the command `cat Pipfile.lock` to view its contents.

  This file should specify which specific versions of the packages in the Pipfile should be used. This prevents automatically upgrading packages that depend upon each other, and risking breaking your project dependency tree.

  You can lock your currently installed packages with the `pipenv lock` command. This  generates the lock file for you automatically, based on your currently installed versions.

## Creating your own pipenv virtual environments

You may wish to create your own virtual environments with Pipenv, rather than using the preinstalled environment provided by Scaleway. This is easily achievable by following the following instructions.

1. Enter the `exit` command to leave the current pipenv virtual environment. 

  You have now left (deactivated) the pre-installed and pre-activated virtual environment, but you are still inside the Docker Container you launched. 

2. Create a new project file for your new virtual environment:


## Exiting the virtual environment and the container




2. From here, you can either:

  - Enter the `exit` command again to leave the Docker container and return to your GPU Instance's shell environment.
  - Create a new `pipenv` virtual environment (separate to the one that was pre-created and pre-activated for you with the container).
  - Reactivate the `pipenv` virtual environment, with the command `pipenv shell`.
